import _Object$keys from '@babel/runtime-corejs3/core-js-stable/object/keys';
import _setTimeout from '@babel/runtime-corejs3/core-js-stable/set-timeout';

/* eslint-env browser */
var transitions = {
  transition: 'transitionend',
  WebkitTransition: 'webkitTransitionEnd',
  MozTransition: 'transitionend',
  OTransition: 'oTransitionEnd otransitionend'
};
var transitionEvent;

if (typeof document !== 'undefined') {
  var _document$createEleme = document.createElement('div'),
      style = _document$createEleme.style;

  var keys = _Object$keys(transitions);

  for (var i = 0, key = keys[i]; i < keys.length; i += 1, key = keys[i]) {
    if (key in style) {
      transitionEvent = transitions[key];
      break;
    }
  }
}

var onTransitionEnd = (function (element, callback, timeout) {
  element.addEventListener(transitionEvent, callback);
  var timeoutId;

  if (timeout) {
    // console.log('onTransitionEnd timeout', timeout);
    timeoutId = _setTimeout(function () {
      element.removeEventListener(transitionEvent, callback);
      callback();
    }, timeout);
  }

  return function () {
    clearTimeout(timeoutId);
    element.removeEventListener(transitionEvent, callback);
  };
});

export default onTransitionEnd;
